<!DOCTYPE html>
<!-- This file is part of PinballY
 Copyright 2018 Michael J Roberts | GPL v3 or later | NO WARRANTY -->
<html>
<head>
   <title>PinballY Help</title>
   <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<script src="jquery-1.12.1.js" type="text/javascript"></script>
<script src="PinballYHelp.js" type="text/javascript"></script>

<h1>mainWindow Object</h1>

<p>
   <b>mainWindow</b> is a pre-defined PinballY object representing the main user
   interface window (the "playfield" window).  This window is the event target
   for most UI-related events, and in many ways it serves as the Javascript
   object that represents the overall PinballY application.
</p>

<h2>Event target</h2>

<p>
   mainWindow is an event target object, so you can use the standard
   event methods (on(), off(), addEventListener(), etc) to add and remove
   event listeners.  See <a href="EventTarget.html">EventTarget</a>.
</p>
<p>
   mainWindow serves as the event target for the following event types:
</p>

<div id="eventTargetTOC" data-eventtarget="mainWindow"></div>


<h2>Methods and properties</h2>

<p>
   The mainWindow object provides the <a href="WindowObjects.html#common">common
   window methods and properties</a>.  It also provides the additional
   items listed below.
</p>

<p>
   <a name="doCommand"></a>
   <b>mainWindow.doCommand(<i>id</i>):</b>  Executes the command specified by
   <i>id</i>, which is one of the integer command codes in the
   <a href="Commands.html">Commands</a> set.
</p>

<p>
   <a name="endAttractMode"></a>
   <b>mainWindow.endAttractMode():</b>  Exits "Attract Mode" if it's currently
   active.  There's no effect if the program isn't already in attract mode.
   The <a href="AttractModeEvent.html"><b>attractmodeend</b></a> event isn't
   fired when you use this method.

<p>
   <a name="getActiveWindow"></a>
   <b>mainWindow.getActiveWindow():</b>  Returns the <a href="WindowObjects.html">window object</a> (mainWindow,
   <a href="BackglassWindow.html">backglassWindow</a>, etc) corresponding to the
   current active window in the application.  This is the active window at the
   operating system level, which means that it's in the foreground and has
   keyboard focus.  If the application is currently in the background, none
   of the windows are active, so this returns null.
</p>
   
<p>
   <a name="getUIMode"></a>
   <b>mainWindow.getUIMode():</b>  Returns an object describing the current UI
   state.  Here's a quick summary of the object's contents:
</p>
<div class="code">
{
    mode: "wheel",         // see list
    gameId: 17,            // ID of currently selected game
    menuID: "main",        // see list; present only in "menu" mode
    popupID: "about box",  // see list; present only in "popup" mode
    runMode: "running",    // or "starting", "exiting"; present only when a game is running
    capture: "single"      // or "batch"; present only when running a game in media capture mode
}
</div>
<p>
   The main state is given by the property .mode, which has one of the values
   listed below.  Depending on the mode, other properties of the object might
   be present to provide additional information.
</p>
<ul>
   <li>"wheel": in the normal game wheel UI, awaiting a command

   <li>"menu": a menu is being displayed (this refers to the graphical
   menu that PinballY displays as an overlay in the playfield window, not
   a standard Windows menu).  In this case, the .menuID property of the
   mode object will contain a string identifying which particular menu
   is being displayed.  See <a href="Menus.html#systemMenus">system menus</a>
   for a list of the built-in menus and their identifiers.

   <li>"popup": a popup box is being displayed.  The .popupID property of
   the mode object is a string specifying the type of popup.  See
   <a href="Popups.html#systemPopups">system popups</a> for a list
   of the system popup types.

   <li>"running": a running game is in progress.  Note that "menu" mode can
   supersede this, since the user can still bring up menus while a game is
   running.  You can determine for sure whether or not a game is running by
   checking for the presence of another property, .runMode, which will be
   present if and only if a game is running.  If present,
   .runMode will be set to the string "starting" (the game has been launched
   but hasn't opened its UI window yet), "running" (the game is in progress),
   or "exiting" (PinballY has closed the game and is waiting for the process
   to exit).  In addition, if the game is running for the purposes of media
   capture, the property .capture will be present, and will be set to the
   string "single" for a single-game capture or "batch" for a batch capture.

   <li>"attract": attract mode/screen saver mode (meaning that there hasn't
   been any user input for the period of time configured in the settings to
   activate attract mode)
</ul>
<p>
   The .gameId property identifies the game that's currently selected in
   the wheel, if any.  This is present regardless of which UI mode is
   in effect.  The game ID is an integer value that you can pass to
   <a href="GameList.html#getGameInfo">gameList.getGameInfo()</a> to retrieve
   the game's details.  The .gameId property will be omitted (so it'll read
   as undefined) if no game is selected, which can only happen when the wheel
   is completely empty.  The wheel can be empty when the program can't find
   any installed games, or when a filter is selected that doesn't match
   any games.
</p>

<p>
   <a name="message"></a>
   <b>mainWindow.message(<i>message</i>, <i>style</i>):</b>  Shows a message using a
   graphical popup box in the main window.  Unlike the global alert() function,
   this doesn't pause the script until the user acknowledges the message;
   it simply shows or queues the message and returns immediately.  This
   is a good option for showing error messages or status updates, since it
   doesn't interrupt the flow of the user interface with a modal dialog.
   If <i>style</i> is provided, it's a string value specifying the
   visual style of the popup message.  This can be "info", "warning", or
   "error", to show the message with green, orange, or red trim
   (respectively), to visually signal the nature of the message.  The
   regular "info" style is used if <i>style</i> is omitted.
</p>

<p>
   <a name="showMenu"></a>
   <b>mainWindow.showMenu(<i>id</i>, <i>items</i>, <i>options</i>):</b>  Display a custom
   menu in the main window, in the same style as the main menu, exit menu, etc.
   See <a href="Menus.html">Menus</a> for more details.  The <a href="MenuEvent.html"><b>menuopen</b></a>
   event isn't fired when you use this method.
</p>

<p>
   <a name="startAttractMode"></a>
   <b>mainWindow.startAttractMode():</b>  Enters "Attract Mode", the screen saver
   mode that normally kicks in automatically after a period without any user input
   (the exact amount of time is configurable in the settings).  This function
   lets you create your own conditions for entering attract mode. 
   The <a href="AttractModeEvent.html"><b>attractmodestart</b></a> event isn't
   fired when you use this method.
</p>

</body>
</html>
