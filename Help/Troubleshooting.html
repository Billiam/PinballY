<!DOCTYPE html>
<!-- This file is part of PinballY
 Copyright 2018 Michael J Roberts | GPL v3 or later | NO WARRANTY -->
<html>
<head>
   <title>PinballY Help</title>
   <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<script src="jquery-1.12.1.js" type="text/javascript"></script>
<script src="PinballYHelp.js" type="text/javascript"></script>

<h1>Troubleshooting Tips</h1>

<p>
   This section is a collection of tips for troubleshooting any
   problems you run into with PinballY.
</p>

<h2>General troubleshooting advice</h2>

Here are a couple of items of general advice that should apply to just
about any issue you run into.

<h3>Asking for help/reporting bugs</h3>
<p>
   If you can't find what you're looking for in this Troubleshooting section
   or elsewhere in the help files, try asking on the
   <a href="https://www.vpforums.org/index.php?showforum=29">vpforums pin cab forum</a>.
   I regularly monitor that group, so I should be able to help if someone
   else doesn't get to your question first.
</p>
<p>
   For any problem that's pretty clearly a program bug, you can raise
   it on the forum, or you can file a bug report using the PinballY
   <a href="https://github.com/mjrgh/PinballY/issues">issue tracker</a>
   on GitHub.  Before filing a report, please read
   <a href="https://github.com/mjrgh/PinballY/wiki/How-to-write-a-good-bug-report">How to write a good bug report</a>.
   Following that advice will improve the chances that I can 
   find and fix the problem.
</p>

<h3>Check the log file</h3>

<p>
   Many problems can be solved by checking PinballY's log file.  Every
   time you run PinballY, it creates a log file called <b>PinballY.log</b>
   in its main program folder.  As the program runs, it writes a bunch
   of miscellaneous status reports to the log file about what it's
   trying to do.  It also record technical details about many sorts
   of system errors here.   The point is to save extra details that might
   be important in case of problems, without barraging you with
   technical status messages in the graphical UI.
</p>
<p>
   You've probably experienced situations where too much information
   is as bad as no information at all.  Too much can create a haystack
   that makes it hard to find the needle.  PinballY
   therefore lets you control the amount of information reported in
   the log file, via the <a href="LogFileOptions.html">Log File</a>
   page in the settings.  That page lets you filter the type of
   actions that PinballY reports in the log.  So before you consult
   the log file, you should go to the Log File options page and
   make sure that reporting is enabled for the subsystem that
   you're trying to troubleshoot.  You might also want to turn off
   logging for unrelated areas, to minimize the amount of other
   reports that you have to sift through.
</p>

<h2>Some common problems (and suggested solutions)</h2>

The topics below list some of the more common problems that I've heard
about, with suggestions for fixes or ways to gather more information.
Scan through the list to see if you can find anything that sounds
similar to any problems you're having.

<h3>I'm running PinballY in Admin mode, and...</h3>

<p>
   ...something's going wrong.
</p>
<p>
  Simple answer: Don't run PinballY in Admin mode.  If you're running
  PinballY by right-clicking the program file and selecting "Run as Administrator",
  please see the help section on <a href="AdminMode.html">Administrator Mode</a>
  for instructions on what you should be doing instead.
</p>
<p>
   But more importantly, you ideally shouldn't need to use Admin
   Mode at all with PinballY.  There are two main reasons that most
   people think they need to use Admin Mode:
</p>
<ul>
   <li>Because you read some advice on the forums or in a tutorial saying
   you should just run <i>everything</i> in Admin mode all the time.
   People mean well when they say that, but it's generally bad advice.
   See <a href="http://mjrnet.org/pinscape/BuildGuideV2/BuildGuide.php?sid=software#AdminModeAllTheTime">
         Should I use "Run as Administrator" for everything?</a> in the
      <a href=http://mjrnet.org/pinscape/BuildGuideV2/">Pinscape Build Guide</a>
      for an explanation.
   </p>
   <p>
      If this kind of blanket advice is the only reason you're using Admin Mode
      with PinballY (rather than an attempt to solve a specific problem), you should
      try undoing it and running everything without Admin Mode instead.
   </p>

   <li>Because some program you're launching from PinballY can only run in Admin Mode.  In
   the first place, I'd consider such a requirement in the other program
   to be a bug; see the Build Guide section linked above for why.
   But if you really can't live without the other program, and it really
   can't run any other way, go read the help section on <a href="AdminMode.html">Administrator Mode</a>.
   PinballY has the capability to launch Admin mode programs <i>without running
   in Admin Mode itself</i>.  Take advantage of that to give the other program
   its Admin Mode launch, without forcing everything else to run in Admin Mode too.
</ul>


<h3>PinballY isn't finding my tables</h3>

<p>
   The easiest way to figure out what's wrong when PinballY can't
   find some or all of your tables is to look at the <b>log file</b>.
   PinballY creates this file each time it runs, writing lots of extra
   technical details on what it's doing during the session.  This can
   usually pinpoint what's going wrong during table searches.
</p>
<p>
   To get detailed information on table searches:
</p>
<ul>
   <li>Open the Settings dialog
   <li>Go to the Log File page
   <li>Make sure that the checkbox <b>Player system setup and table searches</b> is ticked
   <li>Save settings and exit the program
   <li>Run PinballY again, let it finish starting up, then exit
   <li>Use Notepad to view the file <b>PinballY.log</b> (in your main PinballY install folder)
</ul>
<p>
   Now read through the file for an account of where the program is
   looking for table files and what it's finding.
</p>
<p>
   For a detailed explanation of exactly where PinballY looks for tables,
   see <a href="DirectoryInfo.html">Files &amp; Folders</a>.
</p>


<h3>PinballY isn't showing media for my tables</h3>

<p>
   As with table search problems, the log file is the first place
   to look when PinballY isn't finding your media files.
   If you're having trouble getting most or all of your media
   files displayed, try this:
</p>
<ul>
   <li>Open the Settings dialog
   <li>Go to the Log File page
   <li>Make sure that the checkbox <b>Media file searches</b> is ticked
   <li>Save settings
   <li>Navigate to a game that isn't showing the right media files
   <li>Exit the program
   <li>Use Notepad to view the file <b>PinballY.log</b> (in your main PinballY install folder)
</ul>
<p>
   Now read through the file for an account of where the program is
   looking for media files and what it's finding.
</p>
<p>
   If you're having trouble with media for just a few specific games,
   try the built-in media list viewer:
</p>
<ul>
   <li>Navigate to the game in question
   <li>Bring up the Operator Menu (press the digit zero "0" key, or whichever other key you've assigned)
   <li>Select <b>Show Media Files</b>
</ul>
<p>
   That will display details on where the system is looking for
   the game's media, the filename(s) it's looking for, and the
   full names and locations for all of the matching files.  You
   can check the file names that PinballY expects to find against
   the actual files on your disk, and likewise check the directory
   paths to make sure that you're placing the files where the
   program is looking for them.
</p>
<p>
   For a detailed explanation of exactly where PinballY looks for media,
   see <a href="DirectoryInfo.html">Files &amp; Folders</a>.
</p>

<h3>I have a VP X game, but I can only select VP 9 in the Edit Game Details box (not VP X!)</h3>

<p>
   Here's the situation:
</p>
<ul>
   <li>You have some Visual Pinball X  (.vpx) game
   <li>When you try to launch the game, PinballY keeps launching VP 9 instead of VP X
   <li>When you go the Edit Game Details box to try to fix this,
   the "System" drop list only lets you choose from Visual Pinball 9 or Visual Pinball 9.2,
   <b>not</b> VP X as it should be
</ul>
<p>
   The most likely problem (and solution) is described in the topic
   <b>PinballY thinks my Visual Pinball X tables are Visual Pinball 9 tables</b>
   below.
</p>

<h3>PinballY thinks my Visual Pinball <u>X</u> tables are Visual Pinball <u>9</u> tables</h3>

<p>
   Did you just migrate to PinballY from PinballX?  And did you tell
   PinballY to use the table databases and media files you already
   had set up for PinballX?  If so, here's what's probably wrong:
</p>
<div class="indented">
   Your PinballX table database folder for Visual PinballX was probably
   called <b>Visual Pinball</b>
</div>
<p>
   That might seem perfectly natural, especially if you only started
   playing around with VP games recently and mostly use VP X rather
   than the older VP 9 games.  But PinballY doesn't know that!
   PinballY is set up by default to work with <i>both</i> VP 9 and
   VP X.  In fact, it's set up to work with multiple versions of
   VP 9, since there are several sub-versions of VP 9 whose games
   require those specific versions (like VP 9.2 and "PhysMod 5").
   To deal with this, the default settings in PinballY (the ones you
   get when you first install the program) use the following database
   folder names:
</p>
<ul>
   <li>Visual Pinball 9's database folder is <b>Visual Pinball</b>
   <li>Visual Pinball 9.2's database folder is <b>Visual Pinball 9.2</b>
   <li>Visual Pinball X's database folder is <b>Visual Pinball X</b>
</ul>

<p>
   See the problem?  When PinballY loads the system databases, it
   looks at the settings, and it sees that the database folder for
   Visual Pinball 9 is called <b>Visual Pinball</b>, so it looks
   at the tables listed there.  But you put all of your VP X games
   there when you were using PinballX.  So PinballY thinks that
   your VP X games are actually VP 9 games.
      
<p>
   Here's the solution:
</p>
<ul>
   <li>Open the Settings dialog
   <li>Open the system page for Visual Pinball 9
   <li>Change the database folder to <b>Visual Pinball 9</b>
   <li>Open the system page for Visual Pinball X
   <li>Change the database folder to <b>Visual Pinball</b>
</ul>
<p>
   PinballY should now be in sync with your old PinballX settings.  There's
   no need to move or rename any of the PinballX files.  It's just a matter
   of changing the PinballY settings to match the folder names you're using.
</p>


<h3>PinballY doesn't have keyboard focus at system startup</h3>

<p>
   Symptom: You've set up PinballY to start up automatically with
   Windows, but each time you start up the system, PinballY ignores
   key presses.  You have to click on the PinballY window to give
   it keyboard focus.
</p>
<p>
   Causes: If you're using Windows 10, this is probably due to a change
   that Microsoft made in Task Scheduler (which PinballY uses for
   startup launching).  Microsoft changed Task Scheduler in Win 10 so
   that it doesn't give keyboard focus to the programs it launches.
   This might sound like a bug, and it kind of is for our purposes, but
   they did this intentionally because they consider auto-launch programs
   to be "background" tasks that shouldn't interrupt the user.  It would have
   been nice if they'd provided an option setting one way or the other
   on that, but they didn't.
</p>
<p>
   The only solution I've found to this issue is to make PinballY
   force keyboard focus into its own window at some time after it
   starts up.  In the Startup options dialog, try checking the box
   for "Force keyboard focus to PinballY at startup".  If that
   doesn't help, try increasing the delay time on the focus change.
</p>
<p>
   If you're using a pre-Windows 10 system, Task Scheduler normally
   does give focus to newly launched tasks.  The most common thing that
   can prevent PinballY from having keyboard is another program
   "stealing" focus by starting up shortly after PinballY does.
   In most cases, the most recently launched program gets focus,
   so if something launches after PinballY during your system
   startup process, it usually gets focus by taking it away from
   PinballY.  To deal with this, try increasing the startup delay
   parameter in the Startup options dialog ("After logon, pause
   before starting PinballY").
</p>


<h3>PinballY won't save/restore my backglass window position</h3>

<p>
   Symptom:  Each time you start a new PinballY session, the backglass
   window (or one of the other windows) opens at the wrong position.
   It won't stay where you left it at the end of the last session.
</p>
<p>
   The usual cause of this problem is that you're running some other
   program that's changing the screen resolution or monitor layout
   between sessions.  For example, you might be using a program that
   rotates your monitors or changes the desktop resolution each time
   you run certain programs, or you might be using a remote access
   program that changes the screen resolution during remote sessions.
</p>
<p>
   The reason PinballY moves the windows around in these situations
   is that it normally checks all of the restored window positions to
   make sure they're in the visible desktop area at program startup.
   If any windows are outside of the visible area, PinballY moves
   them into the visible area.  This is intended to help with rare
   cases where you <i>permanently</i> change the desktop layout at
   the hardware level, such as when you add a new monitor or replace an
   old one with a new one of a different size.  But it can be a nuisance
   if you <i>routinely</i> change your desktop layout at the software level,
   such as if you need to change the layout every time you run a
   certain application.
</p>
<p>
   The easy fix that usually works is to tell PinballY to stop
   forcing windows into the visible desktop area at the start of
   every session:
</p>
<ul>
   <li>Open the Settings dialog in PinballY
   <li>Go to the <b>Startup</b> section
   <li><b>Un-check</b> the box <b>Make sure all windows are positioned within the
      visible desktop area</b>
</ul>

<p>
   If that still doesn't help, and the window that's not "sticking"
   to its proper position is in full-screen mode, there's a second
   option setting that might help:
</p>
<ul>
   <li>Open the Settings dialog in PinballY
   <li>Go to the <b>Startup</b> section
   <li>Under <b>Restore full-screen windows based on:</b>, select
   <b>Exact saved pixel coordinates</b>
</ul>
<p>
   If none of that helps, try turning on logging for <b>Window layout setup</b>
   (in the Log File section of the settings dialog).  The next time you
   encounter the problem with a saved window position, exit PinballY and
   check the log file for details about window layout setup.  That should
   explain why PinballY is making the decisions it's making about window
   placement, which hopefully will suggest an appropriate solution.
</p>


<h3>The Windows taskbar pops up every time a VP X game finishes</h3>

<p>Try this:</p>
<ul>
   <li>Open the VP X editor (without a game running)
   <li>Select <b>Video/Graphics Options</b> from the Preferences menu
   <li><b>Un-check</b> the box for <b>Disable Desktop Composition</b>
   (in the Fullscreen section)
</ul>
<p>
   What's going on: this checkbox makes VP ask Windows to turn off
   the feature inside Windows that lets it draw partially transparent
   transparent window frames and elements.  VP lets you disable this
   because it can slow down your video card slightly; if you have a
   low-end video card, enabling composition might slow down your
   video card enough to cause hiccups in VP, so disabling it might
   make VP run more smoothly.  The snag is that Windows automatically
   turns composition back on when VP exits, which has the annoying side
   effect of redrawing everything on the screen, which has the
   even more annoying side effect of bringing the taskbar to the
   foreground even if it was hidden. 
</p>
<p>
   PinballY can't do much about that, since Windows has ultimate
   control over what's on the screen.  This is one of those situations
   where Windows asserts its authority and overrides whatever the
   applications would prefer.  So the best way to avoid the problem
   is to tell VP not to make this change in the first place, so that Windows
   doesn't feel the need to redo the whole screen layout every time VP exits.
</p>
<p>
   If you really need to disable desktop composition, it's better to
   disable it <b>globally</b> across your whole system, rather than
   switching it on and off in VP.  To do this:
   In the Windows control panel, select System and Security,
   then System, then Advanced System Settings.  Select the Advanced
   tab.  Click the Settings button.  In the Performance section, find
   "Enable desktop composition", and un-check the box.
</p>
<p>
   Note that if you have Windows 8 or later, you should definitely
   un-check the option in VP, because it doesn't do anything anyway!
   Microsoft stopped letting applications control this after Windows 7.
   Applications can still make the API call (which VP does attempt),
   but Windows simply ignores it on Win 8 and later.
</p>


</body>
</html>
